<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><link rel="stylesheet" href="file:////usr/local/MATLAB/R2017b/toolbox/matlab/codetools/matlab-report-styles.css" type="text/css" /><title>Profile Summary</title></head><body bgcolor="#F8F8F8"><strong>This is a static copy of a profile report</strong><p><a href="file0.html">Home</a><p><title>Function details for compute_J_ellip_celes_posm</title><link rel="stylesheet" href="file:////usr/local/MATLAB/R2017b/toolbox/matlab/codetools/matlab-report-styles.css" type="text/css" /></head><body bgcolor="#F8F8F8"><strong>This is a static copy of a profile report</strong><p><a href="file0.html">Home</a><p><span style="font-size:14pt; background:#FFE4B0">compute_J_ellip_celes_posm (Calls: 2, Time: 2.217 s)</span><br/><i>Generated 28-Nov-2017 15:24:44 using performance time.</i><br/>function in file /home/noise/NOISE_data/Alan/celes-optimization-ellipsoid/sources/mathematics/geometry/ellipsoid/compute_J_ellip_celes_posm.m<br/>Copy to new window for comparing multiple runs<div class="grayline"/><div class="grayline"/><strong>Parents</strong> (calling functions)<br/><p><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" style="background-color:#F0F0F0">Function Name</td><td class="td-linebottomrt" style="background-color:#F0F0F0">Function Type</td><td class="td-linebottomrt" style="background-color:#F0F0F0">Calls</td></tr><tr><td class="td-linebottomrt"><a href="file61.html">compute_Q</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">2</td></tr></table><div class="grayline"/><strong>Lines where the most time was spent</strong><br/> <p><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" style="background-color:#F0F0F0">Line Number</td><td class="td-linebottomrt" style="background-color:#F0F0F0">Code</td><td class="td-linebottomrt" style="background-color:#F0F0F0">Calls</td><td class="td-linebottomrt" style="background-color:#F0F0F0">Total Time</td><td class="td-linebottomrt" style="background-color:#F0F0F0">% Time</td><td class="td-linebottomrt" style="background-color:#F0F0F0">Time Plot</td></tr><tr><td class="td-linebottomrt"><a href="#Line73">73</a></td><td class="td-linebottomrt"><pre>d1j_lp = d1Z_sph_bessel(1,lp,k...</pre></td><td class="td-linebottomrt">350</td><td class="td-linebottomrt">0.152 s</td><td class="td-linebottomrt" class="td-linebottomrt">6.9%</td><td class="td-linebottomrt"><img src="file:////usr/local/MATLAB/R2017b/toolbox/matlab/codetools/private/one-pixel.gif" width=7 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line71">71</a></td><td class="td-linebottomrt"><pre>dj_lp = d1Z_Z_sph_bessel(1,lp,...</pre></td><td class="td-linebottomrt">350</td><td class="td-linebottomrt">0.152 s</td><td class="td-linebottomrt" class="td-linebottomrt">6.8%</td><td class="td-linebottomrt"><img src="file:////usr/local/MATLAB/R2017b/toolbox/matlab/codetools/private/one-pixel.gif" width=7 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line93">93</a></td><td class="td-linebottomrt"><pre>phi_exp = exp(1i*(mp-mi)*phi_m...</pre></td><td class="td-linebottomrt">2450</td><td class="td-linebottomrt">0.085 s</td><td class="td-linebottomrt" class="td-linebottomrt">3.8%</td><td class="td-linebottomrt"><img src="file:////usr/local/MATLAB/R2017b/toolbox/matlab/codetools/private/one-pixel.gif" width=4 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line70">70</a></td><td class="td-linebottomrt"><pre>j_lp = sph_bessel(1,lp,ks*r);</pre></td><td class="td-linebottomrt">350</td><td class="td-linebottomrt">0.082 s</td><td class="td-linebottomrt" class="td-linebottomrt">3.7%</td><td class="td-linebottomrt"><img src="file:////usr/local/MATLAB/R2017b/toolbox/matlab/codetools/private/one-pixel.gif" width=4 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line134">134</a></td><td class="td-linebottomrt"><pre>dJ12_pa = -1i*mp*li*(li+1)/k*p...</pre></td><td class="td-linebottomrt">650</td><td class="td-linebottomrt">0.070 s</td><td class="td-linebottomrt" class="td-linebottomrt">3.1%</td><td class="td-linebottomrt"><img src="file:////usr/local/MATLAB/R2017b/toolbox/matlab/codetools/private/one-pixel.gif" width=3 height=10></td></tr><tr><td class="td-linebottomrt">All other lines</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">1.676 s</td><td class="td-linebottomrt">75.6%</td><td class="td-linebottomrt"><img src="file:////usr/local/MATLAB/R2017b/toolbox/matlab/codetools/private/one-pixel.gif" width=76 height=10></td></tr><tr><td class="td-linebottomrt" style="background-color:#F0F0F0">Totals</td><td class="td-linebottomrt" style="background-color:#F0F0F0">&nbsp;</td><td class="td-linebottomrt" style="background-color:#F0F0F0">&nbsp;</td><td class="td-linebottomrt" style="background-color:#F0F0F0">2.217 s</td><td class="td-linebottomrt" style="background-color:#F0F0F0">100%</td><td class="td-linebottomrt" style="background-color:#F0F0F0">&nbsp;</td></tr></table><div class="grayline"/><b>Children</b> (called functions)<br/><p><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Name</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Type</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Calls</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Total Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">% Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Time Plot</td></tr><tr><td class="td-linebottomrt"><a href="file57.html">d1Z_sph_bessel</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">360</td><td class="td-linebottomrt">0.151 s</td><td class="td-linebottomrt">6.8%</td><td class="td-linebottomrt"><img src="file:////usr/local/MATLAB/R2017b/toolbox/matlab/codetools/private/one-pixel.gif" width=7 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file56.html">d1Z_Z_sph_bessel</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">360</td><td class="td-linebottomrt">0.150 s</td><td class="td-linebottomrt">6.7%</td><td class="td-linebottomrt"><img src="file:////usr/local/MATLAB/R2017b/toolbox/matlab/codetools/private/one-pixel.gif" width=7 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file58.html">sph_bessel</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">360</td><td class="td-linebottomrt">0.079 s</td><td class="td-linebottomrt">3.5%</td><td class="td-linebottomrt"><img src="file:////usr/local/MATLAB/R2017b/toolbox/matlab/codetools/private/one-pixel.gif" width=4 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file51.html">spherical_functions_angular</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">2</td><td class="td-linebottomrt">0.019 s</td><td class="td-linebottomrt">0.8%</td><td class="td-linebottomrt"><img src="file:////usr/local/MATLAB/R2017b/toolbox/matlab/codetools/private/one-pixel.gif" width=1 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file50.html">legendre_normalized_angular</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">2</td><td class="td-linebottomrt">0.011 s</td><td class="td-linebottomrt">0.5%</td><td class="td-linebottomrt"><img src="file:////usr/local/MATLAB/R2017b/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file45.html">generate_gauss_weights_abscissae</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">4</td><td class="td-linebottomrt">0.010 s</td><td class="td-linebottomrt">0.5%</td><td class="td-linebottomrt"><img src="file:////usr/local/MATLAB/R2017b/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file60.html">...J_ellip_celes_posm&gt;selection_rules</a></td><td class="td-linebottomrt">subfunction</td><td class="td-linebottomrt">4900</td><td class="td-linebottomrt">0.009 s</td><td class="td-linebottomrt">0.4%</td><td class="td-linebottomrt"><img src="file:////usr/local/MATLAB/R2017b/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file59.html">multi2single_index</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">2520</td><td class="td-linebottomrt">0.005 s</td><td class="td-linebottomrt">0.2%</td><td class="td-linebottomrt"><img src="file:////usr/local/MATLAB/R2017b/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file55.html">differential_radius</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">2</td><td class="td-linebottomrt">0.003 s</td><td class="td-linebottomrt">0.1%</td><td class="td-linebottomrt"><img src="file:////usr/local/MATLAB/R2017b/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file48.html">area_chain_term</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">2</td><td class="td-linebottomrt">0.002 s</td><td class="td-linebottomrt">0.1%</td><td class="td-linebottomrt"><img src="file:////usr/local/MATLAB/R2017b/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file47.html">meshgrid</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">4</td><td class="td-linebottomrt">0.002 s</td><td class="td-linebottomrt">0.1%</td><td class="td-linebottomrt"><img src="file:////usr/local/MATLAB/R2017b/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file54.html">ellipsoid_function</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">4</td><td class="td-linebottomrt">0.001 s</td><td class="td-linebottomrt">0.1%</td><td class="td-linebottomrt"><img src="file:////usr/local/MATLAB/R2017b/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file49.html">ellip_rad</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">2</td><td class="td-linebottomrt">0.001 s</td><td class="td-linebottomrt">0.1%</td><td class="td-linebottomrt"><img src="file:////usr/local/MATLAB/R2017b/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file44.html">jmult_max</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">2</td><td class="td-linebottomrt">0.000 s</td><td class="td-linebottomrt">0.0%</td><td class="td-linebottomrt"><img src="file:////usr/local/MATLAB/R2017b/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt">Self time (built-ins, overhead, etc.)</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">1.775 s</td><td class="td-linebottomrt">80.1%</td><td class="td-linebottomrt"><img src="file:////usr/local/MATLAB/R2017b/toolbox/matlab/codetools/private/one-pixel.gif" width=80 height=10></td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Totals</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">2.217 s</td><td class="td-linebottomrt" bgcolor="#F0F0F0">100%</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td></tr></table><div class="grayline"/><strong>Code Analyzer results</strong><br/>No Code Analyzer messages.<div class="grayline"/><strong>Coverage results</strong><br/>Show coverage for parent directory<br/><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" style="background-color:#F0F0F0">Total lines in function</td><td class="td-linebottomrt">143</td></tr><tr><td class="td-linebottomrt" style="background-color:#F0F0F0">Non-code lines (comments, blank lines)</td><td class="td-linebottomrt">28</td></tr><tr><td class="td-linebottomrt" style="background-color:#F0F0F0">Code lines (lines that can run)</td><td class="td-linebottomrt">115</td></tr><tr><td class="td-linebottomrt" style="background-color:#F0F0F0">Code lines that did run</td><td class="td-linebottomrt">115</td></tr><tr><td class="td-linebottomrt" style="background-color:#F0F0F0">Code lines that did not run</td><td class="td-linebottomrt">0</td></tr><tr><td class="td-linebottomrt" style="background-color:#F0F0F0">Coverage (did run/can run)</td><td class="td-linebottomrt">100.00 %</td></tr></table><div class="grayline"/><b>Function listing</b><br/><table id="FunctionListingTable"><tr style="height:20px;"><th><pre><span style="color:#FF0000;">time</span> </pre></th><th><pre><span style="color:#0000FF;">Calls</span> </pre></th><th class="leftAligned" COLSPAN=2><pre><span> line</span></pre></th></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  17</span> </pre></td><td class="leftAligned"><pre><span style="color: #A0A0A0; background: #FFFFFF; padding:1px;">function [J11,J12,J21,J22,dJ11,dJ12,dJ21,dJ22] = compute_J_ellip_celes_posm(lmax,Ntheta,Nphi,a,b,c,ni,ns,lambda,nu)</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.01 </span></pre></td><td><pre><span style="color: #0000FF">      2 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  18</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">tic </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  19</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%preallocate memory for J (nmax/2 x nmax/2)</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.01 </span></pre></td><td><pre><span style="color: #0000FF">      2 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  20</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">nmax = <a href="file44.html">jmult_max</a>(1,lmax); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.01 </span></pre></td><td><pre><span style="color: #0000FF">      2 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  21</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">J11 = zeros(nmax/2); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.01 </span></pre></td><td><pre><span style="color: #0000FF">      2 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  22</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">J12 = zeros(nmax/2); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.01 </span></pre></td><td><pre><span style="color: #0000FF">      2 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  23</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">J21 = zeros(nmax/2); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.01 </span></pre></td><td><pre><span style="color: #0000FF">      2 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  24</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">J22 = zeros(nmax/2); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  25</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%preallocate for dJ (nmax/2 x nmax/2 x 3) 1:a, 2:b, 3:c</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.01 </span></pre></td><td><pre><span style="color: #0000FF">      2 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  26</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">dJ11 = zeros(nmax/2,nmax/2,3); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.01 </span></pre></td><td><pre><span style="color: #0000FF">      2 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  27</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">dJ12 = zeros(nmax/2,nmax/2,3); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.01 </span></pre></td><td><pre><span style="color: #0000FF">      2 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  28</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">dJ21 = zeros(nmax/2,nmax/2,3); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.01 </span></pre></td><td><pre><span style="color: #0000FF">      2 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  29</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">dJ22 = zeros(nmax/2,nmax/2,3); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  30</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%setup for gaussian quadrature in two dimensions</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.01 </span></pre></td><td><pre><span style="color: #0000FF">      2 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  31</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">[theta_i,wtheta_i] = <a href="file45.html">generate_gauss_weights_abscissae</a>(Ntheta,0,pi/2); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.01 </span></pre></td><td><pre><span style="color: #0000FF">      2 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  32</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">[phi_i,wphi_i] = <a href="file45.html">generate_gauss_weights_abscissae</a>(Nphi,0,pi); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  33</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%generate r, theta, phi corresponding to the surface of the ellisoid</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.01 </span></pre></td><td><pre><span style="color: #0000FF">      2 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  34</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">[theta_map,phi_map] = <a href="file47.html">meshgrid</a>(theta_i,phi_i); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.01 </span></pre></td><td><pre><span style="color: #0000FF">      2 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  35</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">r = <a href="file49.html">ellip_rad</a>(theta_map,phi_map,a,b,c); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  36</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%generate weight map</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.01 </span></pre></td><td><pre><span style="color: #0000FF">      2 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  37</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">[wt,wp] = <a href="file47.html">meshgrid</a>(wtheta_i,wphi_i); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.01 </span></pre></td><td><pre><span style="color: #0000FF">      2 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  38</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">weight_map = wt.*wp; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  39</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%k vector freespace and in scatterer</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.01 </span></pre></td><td><pre><span style="color: #0000FF">      2 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  40</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">k = 2*pi*ni/lambda; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre><span style="color: #0000FF">      2 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  41</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">ks = 2*pi*ns/lambda; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  42</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">%associated legendre polynomials</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.01 </span></pre></td><td><pre><span style="color: #0000FF">      2 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  43</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">P_lm = <a href="file50.html">legendre_normalized_angular</a>(theta_map,lmax); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.02 </span></pre></td><td><pre><span style="color: #0000FF">      2 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  44</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFF0F0; padding:1px;">[Pi_lm,Tau_lm] = <a href="file51.html">spherical_functions_angular</a>(theta_map,lmax); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.01 </span></pre></td><td><pre><span style="color: #0000FF">      2 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  45</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">ct = cos(theta_map); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.01 </span></pre></td><td><pre><span style="color: #0000FF">      2 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  46</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">st = sin(theta_map); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.01 </span></pre></td><td><pre><span style="color: #0000FF">      2 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  47</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">cp = cos(phi_map); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.01 </span></pre></td><td><pre><span style="color: #0000FF">      2 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  48</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">sp = sin(phi_map); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.01 </span></pre></td><td><pre><span style="color: #0000FF">      2 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  49</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">ellip1 = <a href="file54.html">ellipsoid_function</a>(a,b,c,phi_map,1); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.01 </span></pre></td><td><pre><span style="color: #0000FF">      2 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  50</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">ellip2 = <a href="file54.html">ellipsoid_function</a>(a,b,c,phi_map,2); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.01 </span></pre></td><td><pre><span style="color: #0000FF">      2 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  51</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">radius_grad = <a href="file55.html">differential_radius</a>(theta_map,phi_map,a,b,c); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.01 </span></pre></td><td><pre><span style="color: #0000FF">      2 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  52</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">[area_theta, area_phi] = <a href="file48.html">area_chain_term</a>(theta_map,phi_map,a,b,c); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  53</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;"></span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.01 </span></pre></td><td><pre><span style="color: #0000FF">      2 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  54</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">for li = 1:lmax </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  55</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">    %precompute bessel functions for li,mi and derivative</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.01 </span></pre></td><td><pre><span style="color: #0000FF">     10 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  56</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    b_li = <a href="file58.html">sph_bessel</a>(nu,li,k*r); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.01 </span></pre></td><td><pre><span style="color: #0000FF">     10 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  57</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    db_li = <a href="file56.html">d1Z_Z_sph_bessel</a>(nu,li,k*r); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.01 </span></pre></td><td><pre><span style="color: #0000FF">     10 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  58</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    db2_li = (li+li.^2-(k*r).^2)./(k*r).*b_li; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.01 </span></pre></td><td><pre><span style="color: #0000FF">     10 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  59</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    d1b_li = <a href="file57.html">d1Z_sph_bessel</a>(nu,li,k*r); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.01 </span></pre></td><td><pre><span style="color: #0000FF">     10 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  60</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    for mi = -li:li </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  61</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">        %compute index ni</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.01 </span></pre></td><td><pre><span style="color: #0000FF">     70 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  62</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        ni = <a href="file59.html">multi2single_index</a>(1,1,li,mi,lmax); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  63</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">        %get spherical harmonics (p,pi,tau) and derivatives</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.01 </span></pre></td><td><pre><span style="color: #0000FF">     70 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  64</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        p_limi = P_lm{li+1,abs(mi)+1}; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.01 </span></pre></td><td><pre><span style="color: #0000FF">     70 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  65</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        pi_limi = Pi_lm{li+1,abs(mi)+1}; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.01 </span></pre></td><td><pre><span style="color: #0000FF">     70 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  66</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        tau_limi = Tau_lm{li+1,abs(mi)+1}; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  67</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">        </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.01 </span></pre></td><td><pre><span style="color: #0000FF">     70 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  68</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        for lp = 1:lmax </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  69</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">            %precompute bessel functions for lp,mp, and derivative</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.08 </span></pre></td><td><pre><span style="color: #0000FF">    350 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  70</span><a name="Line70"></a></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFB8B8; padding:1px;">            j_lp = <a href="file58.html">sph_bessel</a>(1,lp,ks*r); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.15 </span></pre></td><td><pre><span style="color: #0000FF">    350 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  71</span><a name="Line71"></a></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FF8080; padding:1px;">            dj_lp = <a href="file56.html">d1Z_Z_sph_bessel</a>(1,lp,ks*r); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.01 </span></pre></td><td><pre><span style="color: #0000FF">    350 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  72</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            dj2_lp = (lp+lp.^2-(ks*r).^2)./(ks*r).*j_lp; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.15 </span></pre></td><td><pre><span style="color: #0000FF">    350 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  73</span><a name="Line73"></a></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FF8080; padding:1px;">            d1j_lp = <a href="file57.html">d1Z_sph_bessel</a>(1,lp,ks*r); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.01 </span></pre></td><td><pre><span style="color: #0000FF">    350 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  74</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            lfactor = 1/2/sqrt(li*(li+li)*lp*(lp+1)); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.01 </span></pre></td><td><pre><span style="color: #0000FF">    350 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  75</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">            for mp = -lp:lp </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  76</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">                %compute index np</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.02 </span></pre></td><td><pre><span style="color: #0000FF">   2450 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  77</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFF0F0; padding:1px;">                np = <a href="file59.html">multi2single_index</a>(1,1,lp,mp,lmax); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  78</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">                %get spherical harmonics (p,pi,tau) and derivatives</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.01 </span></pre></td><td><pre><span style="color: #0000FF">   2450 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  79</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                p_lpmp = P_lm{lp+1,abs(mp)+1}; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.01 </span></pre></td><td><pre><span style="color: #0000FF">   2450 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  80</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                pi_lpmp = Pi_lm{lp+1,abs(mp)+1}; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.01 </span></pre></td><td><pre><span style="color: #0000FF">   2450 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  81</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                tau_lpmp = Tau_lm{lp+1,abs(mp)+1}; </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  82</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">              </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  83</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">                %setup selection rules for J11,J22</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.01 </span></pre></td><td><pre><span style="color: #0000FF">   2450 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  84</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                selection_rules_1122 = <a href="file60.html">selection_rules</a>(li,mi,lp,mp,1); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  85</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">                </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  86</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">                %setup selection rules for J12,J21</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.01 </span></pre></td><td><pre><span style="color: #0000FF">   2450 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  87</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                selection_rules_1221 = <a href="file60.html">selection_rules</a>(li,mi,lp,mp,2); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  88</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">                </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  89</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">                %gamma factor</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  90</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">                %gamma_limilpmp = gamma_func(lp,mp)*gamma_func(li,-mi);</span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  91</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">                </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  92</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">                %phi exponential phase factor</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.09 </span></pre></td><td><pre><span style="color: #0000FF">   2450 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  93</span><a name="Line93"></a></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFB8B8; padding:1px;">                phi_exp = exp(1i*(mp-mi)*phi_map); </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  94</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">                </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;">  95</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">                %compute J11,J22</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.01 </span></pre></td><td><pre><span style="color: #0000FF">   2450 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  96</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                if selection_rules_1122 ~= 0 </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.01 </span></pre></td><td><pre><span style="color: #0000FF">    576 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  97</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                    prefactor = selection_rules_1122*lfactor*phi_exp; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.03 </span></pre></td><td><pre><span style="color: #0000FF">    576 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  98</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFF0F0; padding:1px;">                    J11(ni,np) = sum(sum(-1i*weight_map.*r.^2.*prefactor.*j_lp.*b_li.*(p_lpmp*mp.*tau_limi+p_limi*mi.*tau_lpmp))); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.01 </span></pre></td><td><pre><span style="color: #0000FF">    576 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; ">  99</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                    f = mp*pi_lpmp.*tau_limi+mi*pi_limi.*tau_lpmp; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.02 </span></pre></td><td><pre><span style="color: #0000FF">    576 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 100</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFF0F0; padding:1px;">                    g = 1i*mp*li*(li+1)*pi_lpmp.*p_limi; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.04 </span></pre></td><td><pre><span style="color: #0000FF">    576 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 101</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFE2E2; padding:1px;">                    h = 1i*mi*lp*(lp+1)*pi_limi.*p_lpmp; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.01 </span></pre></td><td><pre><span style="color: #0000FF">    576 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 102</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                    i = lp*(lp+1)*p_lpmp.*tau_limi; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.01 </span></pre></td><td><pre><span style="color: #0000FF">    576 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 103</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                    j = -li*(li+1)*p_limi.*tau_lpmp; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.02 </span></pre></td><td><pre><span style="color: #0000FF">    576 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 104</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFF0F0; padding:1px;">                    dJ11_t1 = -1i*weight_map.*prefactor.*r.*st.*f.*(r.*(k*d1b_li.*dj_lp+ks*d1j_lp.*b_li)+2*b_li.*j_lp); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.03 </span></pre></td><td><pre><span style="color: #0000FF">    576 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 105</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFF0F0; padding:1px;">                    dJ11(ni,np,1) = sum(sum(dJ11_t1.*radius_grad(:,:,1))); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.02 </span></pre></td><td><pre><span style="color: #0000FF">    576 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 106</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFF0F0; padding:1px;">                    dJ11(ni,np,2) = sum(sum(dJ11_t1.*radius_grad(:,:,2))); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.04 </span></pre></td><td><pre><span style="color: #0000FF">    576 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 107</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFE2E2; padding:1px;">                    dJ11(ni,np,3) = sum(sum(dJ11_t1.*radius_grad(:,:,3))); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.02 </span></pre></td><td><pre><span style="color: #0000FF">    576 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 108</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFF0F0; padding:1px;">                    term1 = -1i*dj_lp.*db_li/ks/k.*st.*f; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.02 </span></pre></td><td><pre><span style="color: #0000FF">    576 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 109</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFF0F0; padding:1px;">                    term2 = 1i*r.^2/ks/k.*ellip1.*st.*ct.*p_limi.*p_lpmp.*(mp*li*(li+1)*dj_lp.*b_li+mi*lp*(lp+1)*j_lp.*db_li); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.01 </span></pre></td><td><pre><span style="color: #0000FF">    576 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 110</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                    term3 = r.^2/k/ks.*ellip2.*sp.*cp.*st.^2.*(lp*(lp+1)*j_lp.*p_lpmp.*db_li.*tau_limi-li*(li+1)*dj_lp.*tau_lpmp.*b_li.*p_limi); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.02 </span></pre></td><td><pre><span style="color: #0000FF">    576 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 111</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFF0F0; padding:1px;">                    J22(ni,np) = sum(sum(weight_map.*prefactor.*(term1+term2+term3))); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.04 </span></pre></td><td><pre><span style="color: #0000FF">    576 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 112</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFE2E2; padding:1px;">                    dJ22_r = -1i/ks/k*st.*f.*(ks*dj2_lp.*db_li+k*db2_li.*dj_lp); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.02 </span></pre></td><td><pre><span style="color: #0000FF">    576 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 113</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFF0F0; padding:1px;">                    dJ22_tp1 = 1/k/ks*r.^2.*st.^2.*((ellip1.*ct.*g+ellip2.*sp.*cp.*j).*(k*d1b_li.*dj_lp+ks*dj2_lp.*b_li)+(ellip1.*ct.*h+ellip2.*sp.*cp.*i).*(ks*d1j_lp.*db_li+k*db2_li.*j_lp)); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.07 </span></pre></td><td><pre><span style="color: #0000FF">    576 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 114</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFC6C6; padding:1px;">                    dJ22_tpa = 2/k/ks*st.^2.*r.*((radius_grad(:,:,1).*ellip1+area_theta(:,:,1)).*ct.*(b_li.*dj_lp.*g+db_li.*j_lp.*h)+(radius_grad(:,:,1).*ellip2+area_phi(:,:,1)).*sp.*cp.*(b_li.*dj_lp.*j+db_li.*j_lp.*i)); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.07 </span></pre></td><td><pre><span style="color: #0000FF">    576 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 115</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFC6C6; padding:1px;">                    dJ22_tpb = 2/k/ks*st.^2.*r.*((radius_grad(:,:,1).*ellip1+area_theta(:,:,1)).*ct.*(b_li.*dj_lp.*g+db_li.*j_lp.*h)+(radius_grad(:,:,2).*ellip2+area_phi(:,:,2)).*sp.*cp.*(b_li.*dj_lp.*j+db_li.*j_lp.*i)); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.04 </span></pre></td><td><pre><span style="color: #0000FF">    576 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 116</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFE2E2; padding:1px;">                    dJ22_tpc = 2/k/ks*st.^2.*r.*((radius_grad(:,:,1).*ellip1+area_theta(:,:,1)).*ct.*(b_li.*dj_lp.*g+db_li.*j_lp.*h)); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.02 </span></pre></td><td><pre><span style="color: #0000FF">    576 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 117</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFF0F0; padding:1px;">                    dJ22(ni,np,1) = sum(sum(prefactor.*weight_map.*(dJ22_r+dJ22_tp1+dJ22_tpa))); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.02 </span></pre></td><td><pre><span style="color: #0000FF">    576 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 118</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFF0F0; padding:1px;">                    dJ22(ni,np,2) = sum(sum(prefactor.*weight_map.*(dJ22_r+dJ22_tp1+dJ22_tpb))); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.02 </span></pre></td><td><pre><span style="color: #0000FF">    576 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 119</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFF0F0; padding:1px;">                    dJ22(ni,np,3) = sum(sum(prefactor.*weight_map.*(dJ22_r+dJ22_tp1+dJ22_tpc))); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.01 </span></pre></td><td><pre><span style="color: #0000FF">    576 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 120</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                end </span><br/></pre></td></tr><tr><td><pre></pre></td><td><pre></pre></td><td><pre><span style="color: #A0A0A0; margin:0;"> 121</span> </pre></td><td class="leftAligned"><pre><span style="color: #228B22; background: #FFFFFF; padding:1px;">                %compute J12,J21</span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.03 </span></pre></td><td><pre><span style="color: #0000FF">   2450 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 122</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFE2E2; padding:1px;">                if selection_rules_1221 ~= 0 </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.01 </span></pre></td><td><pre><span style="color: #0000FF">    650 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 123</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                    prefactor = selection_rules_1221*lfactor*phi_exp; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.01 </span></pre></td><td><pre><span style="color: #0000FF">    650 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 124</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                    ang1 = mp*mi.*pi_lpmp.*pi_limi+tau_lpmp.*tau_limi; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.01 </span></pre></td><td><pre><span style="color: #0000FF">    650 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 125</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                    bj_lilp = b_li.*j_lp; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.01 </span></pre></td><td><pre><span style="color: #0000FF">    650 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 126</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                    dbj_lilp = ks*d1j_lp.*b_li+k*d1b_li.*j_lp; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.01 </span></pre></td><td><pre><span style="color: #0000FF">    650 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 127</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                    term1 = ang1.*r.*st/k.*db_li.*j_lp; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.03 </span></pre></td><td><pre><span style="color: #0000FF">    650 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 128</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFF0F0; padding:1px;">                    term2 = -r.^3/k*li*(li+1).*st.*db_li.*p_limi.*j_lp.*(ellip1.*st.*ct.*tau_lpmp+ellip2.*sp.*cp.*st.*p_lpmp*1i*mp); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.03 </span></pre></td><td><pre><span style="color: #0000FF">    650 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 129</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFE2E2; padding:1px;">                    J12(ni,np) = sum(sum(weight_map.*prefactor.*(term1+term2))); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.01 </span></pre></td><td><pre><span style="color: #0000FF">    650 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 130</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                    dJ12_r = 1/k*st.*ang1.*(r.*(k*db2_li.*j_lp+ks*d1j_lp.*db_li)+db_li.*j_lp); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.04 </span></pre></td><td><pre><span style="color: #0000FF">    650 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 131</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFE2E2; padding:1px;">                    dJ12_ta = -li*(li+1)/k*p_limi.*tau_lpmp.*r.^2.*st.^2.*ct.*(ellip1.*(3*bj_lilp+r.*dbj_lilp).*radius_grad(:,:,1)+2*area_theta(:,:,1).*bj_lilp); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.04 </span></pre></td><td><pre><span style="color: #0000FF">    650 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 132</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFE2E2; padding:1px;">                    dJ12_tb = -li*(li+1)/k*p_limi.*tau_lpmp.*r.^2.*st.^2.*ct.*(ellip1.*(3*bj_lilp+r.*dbj_lilp).*radius_grad(:,:,2)+2*area_theta(:,:,2).*bj_lilp); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.04 </span></pre></td><td><pre><span style="color: #0000FF">    650 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 133</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFE2E2; padding:1px;">                    dJ12_tc = -li*(li+1)/k*p_limi.*tau_lpmp.*r.^2.*st.^2.*ct.*(ellip1.*(3*bj_lilp+r.*dbj_lilp).*radius_grad(:,:,3)+2*area_theta(:,:,3).*bj_lilp); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.07 </span></pre></td><td><pre><span style="color: #0000FF">    650 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 134</span><a name="Line134"></a></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFC6C6; padding:1px;">                    dJ12_pa = -1i*mp*li*(li+1)/k*p_limi.*pi_lpmp.*r.^2.*st.^2.*sp.*cp.*(ellip2.*(3*bj_lilp+r.*dbj_lilp).*radius_grad(:,:,1)+2*area_phi(:,:,1).*bj_lilp); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.07 </span></pre></td><td><pre><span style="color: #0000FF">    650 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 135</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFC6C6; padding:1px;">                    dJ12_pb = -1i*mp*li*(li+1)/k*p_limi.*pi_lpmp.*r.^2.*st.^2.*sp.*cp.*(ellip2.*(3*bj_lilp+r.*dbj_lilp).*radius_grad(:,:,2)+2*area_phi(:,:,2).*bj_lilp); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.06 </span></pre></td><td><pre><span style="color: #0000FF">    650 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 136</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFD4D4; padding:1px;">                    dJ12_pc = -1i*mp*li*(li+1)/k*p_limi.*pi_lpmp.*r.^2.*st.^2.*sp.*cp.*(ellip2.*(3*bj_lilp+r.*dbj_lilp).*radius_grad(:,:,3)); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.03 </span></pre></td><td><pre><span style="color: #0000FF">    650 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 137</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFF0F0; padding:1px;">                    dJ12(ni,np,1) = sum(sum(prefactor.*weight_map.*(dJ12_r+dJ12_ta+dJ12_pa))); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.02 </span></pre></td><td><pre><span style="color: #0000FF">    650 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 138</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFF0F0; padding:1px;">                    dJ12(ni,np,2) = sum(sum(prefactor.*weight_map.*(dJ12_r+dJ12_tb+dJ12_pb))); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.03 </span></pre></td><td><pre><span style="color: #0000FF">    650 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 139</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFE2E2; padding:1px;">                    dJ12(ni,np,3) = sum(sum(prefactor.*weight_map.*(dJ12_r+dJ12_tc+dJ12_pc))); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.01 </span></pre></td><td><pre><span style="color: #0000FF">    650 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 140</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                    term1 = -ang1.*r.*st/ks.*dj_lp.*b_li; </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.03 </span></pre></td><td><pre><span style="color: #0000FF">    650 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 141</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFF0F0; padding:1px;">                    term2 = r.^3/ks*lp*(lp+1).*st.*dj_lp.*p_lpmp.*b_li.*(ellip1.*st.*ct.*tau_limi-ellip2.*sp.*cp.*st.*p_limi*1i*mi); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.03 </span></pre></td><td><pre><span style="color: #0000FF">    650 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 142</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFF0F0; padding:1px;">                    J21(ni,np) = sum(sum(weight_map.*prefactor.*(term1+term2))); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.01 </span></pre></td><td><pre><span style="color: #0000FF">    650 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 143</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                    dJ21_r = 1/ks*st.*ang1.*(r.*(ks*dj2_lp.*b_li+k*d1b_li.*dj_lp)+b_li.*dj_lp); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.04 </span></pre></td><td><pre><span style="color: #0000FF">    650 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 144</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFE2E2; padding:1px;">                    dJ21_ta = -lp*(lp+1)/ks*p_lpmp.*tau_limi.*r.^2.*st.^2.*ct.*(ellip1.*(3*bj_lilp+r.*dbj_lilp).*radius_grad(:,:,1)+2*area_theta(:,:,1).*bj_lilp); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.04 </span></pre></td><td><pre><span style="color: #0000FF">    650 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 145</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFE2E2; padding:1px;">                    dJ21_tb = -lp*(lp+1)/ks*p_lpmp.*tau_limi.*r.^2.*st.^2.*ct.*(ellip1.*(3*bj_lilp+r.*dbj_lilp).*radius_grad(:,:,2)+2*area_theta(:,:,2).*bj_lilp); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.04 </span></pre></td><td><pre><span style="color: #0000FF">    650 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 146</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFE2E2; padding:1px;">                    dJ21_tc = -lp*(lp+1)/ks*p_lpmp.*tau_limi.*r.^2.*st.^2.*ct.*(ellip1.*(3*bj_lilp+r.*dbj_lilp).*radius_grad(:,:,3)+2*area_theta(:,:,3).*bj_lilp); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.07 </span></pre></td><td><pre><span style="color: #0000FF">    650 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 147</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFC6C6; padding:1px;">                    dJ21_pa = -1i*mi*lp*(lp+1)/ks*p_lpmp.*pi_limi.*r.^2.*st.^2.*sp.*cp.*(ellip2.*(3*bj_lilp+r.*dbj_lilp).*radius_grad(:,:,1)+2*area_phi(:,:,1).*bj_lilp); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.06 </span></pre></td><td><pre><span style="color: #0000FF">    650 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 148</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFC6C6; padding:1px;">                    dJ21_pb = -1i*mi*lp*(lp+1)/ks*p_lpmp.*pi_limi.*r.^2.*st.^2.*sp.*cp.*(ellip2.*(3*bj_lilp+r.*dbj_lilp).*radius_grad(:,:,2)+2*area_phi(:,:,2).*bj_lilp); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.06 </span></pre></td><td><pre><span style="color: #0000FF">    650 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 149</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFD4D4; padding:1px;">                    dJ21_pc = -1i*mi*lp*(lp+1)/ks*p_lpmp.*pi_limi.*r.^2.*st.^2.*sp.*cp.*(ellip2.*(3*bj_lilp+r.*dbj_lilp).*radius_grad(:,:,3)); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.03 </span></pre></td><td><pre><span style="color: #0000FF">    650 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 150</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFF0F0; padding:1px;">                    dJ21(ni,np,1) = sum(sum(prefactor.*weight_map.*(dJ21_r+dJ21_ta+dJ21_pa))); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.02 </span></pre></td><td><pre><span style="color: #0000FF">    650 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 151</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFF0F0; padding:1px;">                    dJ21(ni,np,2) = sum(sum(prefactor.*weight_map.*(dJ21_r+dJ21_tb+dJ21_pb))); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.02 </span></pre></td><td><pre><span style="color: #0000FF">    650 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 152</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFF0F0; padding:1px;">                    dJ21(ni,np,3) = sum(sum(prefactor.*weight_map.*(dJ21_r+dJ21_tc+dJ21_pc))); </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.01 </span></pre></td><td><pre><span style="color: #0000FF">    650 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 153</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">                end </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.02 </span></pre></td><td><pre><span style="color: #0000FF">   2450 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 154</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFF0F0; padding:1px;">            end </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">  0.01 </span></pre></td><td><pre><span style="color: #0000FF">    350 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 155</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">        end </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.01 </span></pre></td><td><pre><span style="color: #0000FF">     70 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 156</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">    end </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.01 </span></pre></td><td><pre><span style="color: #0000FF">     10 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 157</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">end </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.01 </span></pre></td><td><pre><span style="color: #0000FF">      2 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 158</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">toc </span><br/></pre></td></tr><tr><td><pre><span style="color: #FF0000">&lt; 0.01 </span></pre></td><td><pre><span style="color: #0000FF">      2 </span></pre></td><td><pre><span style="color: #000000; font-weight: bold; margin:0; "> 159</span></pre></td><td class="leftAligned"><pre><span style="color: #000000; background: #FFFFFF; padding:1px;">end </span><br/></pre></td></tr></table><p><p>Other subfunctions in this file are not included in this listing.</body></html>